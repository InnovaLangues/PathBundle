<a class="btn btn-default btn-templates" pageslide="left" ps-speed="0.5" href="#templates-sidebar">
    <span class="icon-heart"></span> Templates
</a>

<div id="templates-sidebar" style="display:none" ng-controller="TemplateCtrl">
    <a id="templates-sidebar-close" href="#" class="btn btn-default btn-xs pull-right"><i class="icon-remove"></i></a>
    <div ng-include="webDir + 'js/Template/Partial/templates-sidebar.html'"></div>
</div>

<div class="row">
    <div class="col-md-7">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h2 class="panel-title"><span class="icon-road"></span> Scenario : &lt;{{ path.name | truncate }}&gt;</h2>
            </div>
            <div class="panel-body" id="zone">
                <ul class="tree">
                    <li ng-repeat="step in path.steps" ng-include="webDir + 'js/Step/Partial/tree-item.html'" onload="isRootNode = ($index == 0)"></li>
                </ul>
            </div>
        </div>
    </div>

    <div class="col-md-5">
        <div class="panel panel-default preview-step">
            <div class="panel-heading">
                <h2 class="panel-title"><span class="icon-leaf"></span> Selected step : <a href="" ng-click="editStep(previewStep)"><strong>&lt;{{ previewStep.name | truncate }}&gt;</strong></a></h2>
                <div class="step-buttons" ng-show="previewStep != null">
                    <button ng-click="editStep(previewStep)" class="btn btn-default btn-sm" tooltip="Edit step"><i class="icon-pencil"></i></button>
                    <button ng-hide="stepIsRootNode" class="btn btn-danger btn-sm" ng-click="remove(previewStep)" tooltip="Delete step">
                        <i class="icon-trash"></i>
                    </button>
                </div>
            </div>

            <div class="panel-body" ng-hide="previewStep != null">
                <span>No selected step.</span>
            </div>

            <div class="panel-body" ng-show="previewStep != null">
                <div class="icons">
                    <img ng-show="previewStep.who != null && previewStep.who != ''" src="{{ webDir }}images/icons/who/{{ previewStep.who }}" alt="{{ whoList[previewStep.who] }}" tooltip="{{ whoList[previewStep.who] }}" />
                    <img ng-show="previewStep.where != null && previewStep.where != ''" src="{{ webDir }}images/icons/where/{{ previewStep.where }}" alt="{{ whereList[previewStep.where] }}" tooltip="{{ whereList[previewStep.where] }}" />

                    <img ng-show="previewStep.withComputer" src="{{ webDir }}images/icons/computer.png" alt="With computer" tooltip="With computer" />
                    <img ng-show="!previewStep.withComputer" src="{{ webDir }}images/icons/no_computer.png" alt="Without computer" tooltip="Without computer" />

                    <img ng-show="previewStep.withTutor" src="{{ webDir }}images/icons/tutor.png" alt="With tutor" tooltip="With tutor" />
                    <img ng-show="!previewStep.withTutor" src="{{ webDir }}images/icons/no_tutor.png" alt="Without tutor" tooltip="Without tutor" />

                    <span class="duration pull-right">{{ previewStep.durationHours || "0" }}h{{ previewStep.durationMinutes || "00" }}min</span>
                </div>

                <div class="picture">
                    <img ng-show="previewStep.image != null && previewStep.image != ''" src="{{ webDir }}images/steps/{{ previewStep.image }}" />
                </div>

                <br/>

                <h3><span class="icon-info-sign"></span> Instructions</h3>
                <p>{{ previewStep.instructions || "There is no instructions for this step" }}</p>

                <br/>

                <button class="btn btn-xs btn-primary pull-right" ng-click="editResource('document')"><i class="icon-plus"></i></button>
                <h3><i class="icon-briefcase"></i> Documents</h3>

                <table class="table table-condensed table-hover">
                    <!-- Inherited documents from parents -->
                    <tr ng-repeat="resource in inheritedResources | filter: {type: 'document'}">
                        <td class="icon"><img src="{{ webDir }}images/icons/document/16x16/{{ resource.subType }}.png" alt="{{ resource.subType }}" /></td>
                        <td ng-class="{'excluded-resource': resource.isExcluded}">{{ resource.name | truncate }} <small>(from &lt;{{ resource.parentStep | truncate }}&gt;)</small></td>
                        <td class="actions">
                            <button ng-disabled="!resource.isExcluded" class="btn btn-xs btn-success" ng-click="includeParentResource(resource)"><i class="icon-eye-open"></i></button>
                            <button ng-disabled="resource.isExcluded" class="btn btn-xs btn-danger" ng-click="excludeParentResource(resource)"><i class="icon-eye-close"></i></button>
                        </td>
                    </tr>
                    
                    <!-- Specific documents -->
                    <tr ng-repeat="resource in previewStep.resources | filter: {type: 'document'}">
                        <td class="icon"><img src="{{ webDir }}images/icons/document/16x16/{{ resource.subType }}.png" alt="{{ resource.subType }}" /></td>
                        <td>{{ resource.name | truncate }}</td>
                        <td class="actions">
                            <button class="btn btn-xs btn-default" ng-click="editResource('document', resource)" tooltip="Edit"><i class="icon-edit"></i></button>
                            <button class="btn btn-xs btn-danger" ng-click="removeResource(resource)" tooltip="Delete"><i class="icon-trash"></i></button>
                        </td>
                    </tr>
                </table>

                <button class="btn btn-xs btn-primary pull-right" ng-click="editResource('tool')"><i class="icon-plus"></i></button>
                <h3><i class="icon-wrench"></i> Tools</h3>

                <table class="table table-condensed table-hover">
                    <!-- Inherited tools from parents -->
                    <tr ng-repeat="resource in inheritedResources | filter: {type: 'tool'}">
                        <td class="icon"><img src="{{ webDir }}images/icons/tool/16x16/{{ resource.subType }}.png" alt="{{ resource.subType }}" /></td>
                        <td ng-class="{'excluded-resource': resource.isExcluded}">{{ resource.name | truncate }} <small>(from &lt;{{ resource.parentStep | truncate }}&gt;)</small></td>
                        <td class="actions">
                            <button ng-disabled="!resource.isExcluded" class="btn btn-xs btn-success" ng-click="includeParentResource(resource)"><i class="icon-eye-open"></i></button>
                            <button ng-disabled="resource.isExcluded" class="btn btn-xs btn-danger" ng-click="excludeParentResource(resource)"><i class="icon-eye-close"></i></button>
                        </td>
                    </tr>
                    
                    <!-- Specific tools -->
                    <tr ng-repeat="resource in previewStep.resources | filter: {type: 'tool'}">
                        <td class="icon"><img src="{{ webDir }}images/icons/tool/16x16/{{ resource.subType }}.png" alt="{{ resource.subType }}" /></td>
                        <td>{{ resource.name | truncate }}</td>
                        <td class="actions">
                            <button class="btn btn-xs btn-default" ng-click="editResource('tool', resource)" tooltip="Edit"><i class="icon-edit"></i></button>
                            <button class="btn btn-xs btn-danger" ng-click="removeResource(resource)" tooltip="Delete"><i class="icon-trash"></i></button>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>